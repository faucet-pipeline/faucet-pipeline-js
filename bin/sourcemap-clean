#!/usr/bin/env node
// Read JSON from stdin, keep keys passed as arguments, write the result to stdout as JSON

let { Transform } = require("stream");

let args = process.argv.slice(2);
let clean = Transform({
	transform(chunk, encoding, callback) {
		let obj = JSON.parse(chunk);
		Object.keys(obj).
			filter(key => !args.includes(key)).
			forEach(key => delete obj[key]);
		callback(null, JSON.stringify(obj));
	}
});

process.stdin.pipe(clean).pipe(process.stdout);
