#!/usr/bin/env node
"use strict";

let bundler = require("../src");
let parseArgs = require("minimist");

// command-line arguments
// TODO: help message, documenting options (incl. `--no-fingerprint` and `--poll`)
let argv = parseArgs(process.argv.slice(2), {
	alias: {
		c: "config",
		m: "minify",
		w: "watch"
	}
});

let rootDir = process.cwd();
let options = {
	config: argv.config,
	watch: argv.watch && (argv.poll ? "poll" : true),
	suppressFingerprinting: argv.fingerprint === false
};

if(options.watch) {
	console.error(`monitoring file system at ${rootDir}`);

	if(!options.suppressFingerprinting) { // for convenience
		console.error("you might consider using `--no-fingerprint` to avoid " +
				"littering your file system with obsolete bundles");
	}
}

bundler(rootDir, options);
